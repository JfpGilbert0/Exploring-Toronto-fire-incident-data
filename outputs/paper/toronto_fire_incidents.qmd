---
title: "Melting snow: Exploring Toronto Fire Incident Data"
author: 
  - Jacob Gilbert
thanks: "Code and data are available at: [LINK](https://github.com/JfpGilbert0/Exploring-Toronto-fire-incident-data)"
date: today
date-format: long
abstract: "Fire incidents have and will pose a significant problem to the wellbeing of public health and the infrastructure of urban areas. Understanding the patterns and characteristics is essential for policy makers to implement preventative measures. In the ever growing city of Toronto, where population is set to grow 45% across the Greater Toronto Area by 2046 (ontario.ca), the importance of this is ever prevalent."
format: pdf
toc: true
number-sections: true
bibliography: references.bib
---

\newpage

# Introduction {#sec-Introduction}


Prevention of fires is a multifaceted challenge with many unpredictable factors, thus understanding the information we have is essential. Building infrastructure, common causes and environmental factors can all play a part. In a densely populated city the concentration and constant evolution of structures create additional challenges. New buildings and skyscrapers are on the rise in Toronto for residential and industrial purposes and as such a proactive approach is essential for minimising losses.

With such a large geographical area to cover, the GTA  divides its emergency services geographically. Different stations respond to incidents within their surrounding area as to not overencomber each location. With the changes mentioned to population size and density in many areas of Toronto the demands for different areas are likely to change. As a result policy makers will need to understand were this demand is required most to make efficient responses.

The following analysis aims to provide valuable insights for policy makers, emphasising areas of increased frequency and bringing attention to hotspots for areas of increased fiscal damage. Doing this both by geographic location as well as by location use. Finally, look at other features that may contribute to policy makers such as the source of fires, in order to implement educational measures, and time of day for resource allocation.


# Data {#sec-data}

The following report uses fire incident data, and fire service station data opendatatoronto @opendatatoronto obtained through City of Toronto's open data portal. Further map information used in (@fig-1)1 is also from opendatatoronto. this resource is updated regularly by the city of toronto, all rsources are as of 2023. Fire incident data is that of events responded to by the Toronto Fire service, and thus it is assumed that they are the data source. the only data that is incomplete is that which is still under investigation or classified, as the data used is from 2018 - 2022 this is deemded insignificant. The most recent 4 years of data were used in an aim for relevancy giving information on 10,246 incidents.

Key data points were taken from the vast amount of information to analyze patterns and behaviours of which any incomplete information was removed or set to appropriate inputs. One of which datapoints taken was estimated dollar lost as a result of the fire which was used as a measure for extent of damage in this paper. This was the most reliable data thruought the dataset aswell as set an unbiased measure for conscequences of the incidents.

The analysis will be done using R (@citeR) using packages dplyr (@citedplyr), sf (@citesf), janitor (@janitor) and tidyverse (@citetidyverse). All graphs were generated by ggplot2 (@citegg).

# Analysis {#sec-Analysis}
```{r}
#| echo: false
#| warning: false
#| message: false
#| results: hide
#### Workspace setup ####
library(tidyverse)
library(janitor)
library(ggplot2)
library(dplyr)
library(sf)
library(opendatatoronto)

#### Read data ####
fire_event_data <- read_csv(here::here("outputs/data/fire_event_data.csv"))

#### Create fire stations map ####

toronto <- list_package_resources("neighbourhoods") |>
  filter(name == "Neighbourhoods - historical 140 - 4326.zip") |>
  get_resource()

fire_stations <-
  list_package_resources("a6ce5495-8e2b-421a-ab11-964569416f31") |>
  filter(name == "fire-station-locations - 4326.zip") |>
  get_resource()

fire_cost <-
  filter(fire_event_data, estimated_dollar_loss != 0)

sf_data <-
  st_as_sf(fire_cost, coords =  c("longitude", "latitude"), crs = 4326)

```


## Geographical

From the fire incidents dataset provided each incident was allotted coordinate location of the nearest intersection allowing for observations into geographically analysis of the data. The geographical graph (@fig-1) contains a graphed map of toronto with red points indicating fires within buildings and blue for other, outside locations. The size of the points reflects the estimated dollar loss of the incident.

```{R}
#| label: fig-1
#| fig-cap: Fires and fire stations in toronto, size of point represents estimated dollar lost of fire, displays higher density and costs towords downtown
#| echo: false
#| warning: false
#| message: true


### Geographic  cost ###

map <- ggplot() +
  geom_sf(data = toronto, fill = "white", show.legend = TRUE) +
  geom_sf(data = fire_stations, color = "darkgreen", size = 0.5, alpha = 3, show.legend = TRUE) +
  geom_sf(data = sf_data, aes(color = fire_cost$is_not_property), alpha = 0.2,
          size = pmin(0.7*fire_cost$estimated_dollar_loss / mean(fire_cost$estimated_dollar_loss),2),
          show.legend = TRUE) +
  labs(
    x = "latitude",
    y = "longitude"
  ) +
  theme_minimal() +
  scale_color_manual(
    name = "Buildings",
    values = c("blue", "red"),
    labels = c("blue" = "Not a Building", "red" = "Building affected")
  ) +

  theme(
    axis.title = element_text(size = 4),
    axis.text.x = element_text(size = 3),
    axis.text.y = element_text(size = 3),
    legend.position = "right",
    legend.text = element_text(size = 3),
    legend.title = element_text(size = 4),
    legend.key.height = unit(0.5, "cm"),
    legend.key.width = unit(0.5, "cm"))

print(map)

```

Towards the southern end of the GTA a hotspot appears in the data. This area is compact with larger and more densely populated red points. This area is downtown Toronto, filled with highrises and home to 16,000 people per square (@citeontario) kilometre, it clearly comes with fire risk. The increase in density may be attributed to higher condensation of population. Further it is worth noting that the estimated dollar lost here may be positively skewed as a result of more expensive property. However the amount of fires outside of the buildings is proportionally minimal, that is, compared with the rest of the GTA.

Outside of downtown we see plenty of incidents not occuring in residences or businesses but outside. As the estimated cost histogram (@fig-2) emphasises these events are less damaging on average. Thus policy makers may consider this when allocating resources. However the less urban areas aren't without some large incidents, more sporadic as well. Making them further from relative fire stations.

The graph below (@fig-2) does highlight how the proportion of events that are more damaging are on properties. Thus giving an even clearer image of the likelihood of costs for red data (@fig-1) points being high. Showing avoiding these types of incidents is a way to mitigate damages.

```{r}
#| label: fig-2
#| fig-cap: Histogram of fire incident cost seperated by indoor and outdoor events, with large left skew. final bin indicates 10,000+
#| echo: false
#| warning: false
#| message: true

histo_cost <-
  ggplot(fire_event_data, aes(x = pmin(estimated_dollar_loss, 10000), fill = is_not_property)) +
    geom_histogram(bins = 10, position = "identity", alpha = 0.6) +
    scale_fill_manual(
      values = c("blue", "red"),
      name = "fire location",
      labels = c("outside", "Building affected")
    ) +
    theme_minimal() +
    labs(
      x = "Estimated Dollar Loss",
      y = "Frequency"
    )

print(histo_cost)
```

## Hour of day
```{r}
#| label: fig-3
#| fig-cap: frequency of fire incidents by hour, highest frequency later in the evening
#| echo: false
#| warning: false
#| message: true

### Hour of day histogaph

hour_histo <- ggplot(fire_event_data, aes(x = hour)) +
  geom_histogram(binwidth = 1, fill = "darkblue", color = "black", alpha = 0.7) +
  labs(title = "Fire Incidents by Hour of Day",
       x = "Hour of Day",
       y = "Count") +
  theme_minimal()

# Print the histogram
print(hour_histo)

```

Time and space go together hand in hand and the hourly data (@fig-3) looks at the former. Hourly data was available for all observations of the data and thus tells a significant story. Based on the data, fire incidents are less likely to occur in the early hours, from 2 to 9am. Based on time of day, (@fig-3) the Toronto fire department is most likely to be called to an incident in the late hours of the night. Ending around 2am, it is worth noting that the majority of establishments close at this time in Toronto. This could be seen in a positive or negative way due to the potential vacancy of buildings in the early hours. What certainly is an assurance is these hours will coincide with times residents are asleep.

## Ignition sources
```{r}
#| label: fig-4
#| fig-cap: pie chart of the top 10 most common ignition sources 
#| echo: false
#| warning: false
#| message: true

top_ignition_values <- fire_event_data %>%
  count(ignition_source, sort = TRUE) %>%
  slice_head(n = 10) %>%
  pull(ignition_source)

subset_data <- select(filter(fire_event_data, !is.na(ignition_source)), c("ignition_source", "estimated_dollar_loss")) %>%
  filter(ignition_source %in% top_ignition_values)

top_ignition_sources <- subset_data %>%
  group_by(ignition_source) %>%
  summarise(count = n())

pie_chart <- ggplot(top_ignition_sources, aes(x = "", y = count, fill = ignition_source , label = ignition_source)) +
  geom_bar(stat = "identity", width = 1, color = "white", size = 0) +
  coord_polar(theta = "y") +
  theme_minimal() +
  theme(
    axis.text = element_blank(),
        axis.ticks = element_blank(),
    legend.text = element_text(size = 7),
    legend.key.size = unit(0.4,"cm")
  )

print(pie_chart)
```

(@fig-4) gives information on the most common initial ignition sources for fires. The largest proportion of these top causes is "undetermined", this is not a result of bad data. In fact this is a result of the type of data, as some fires are already past the point of collecting this information. However the remainder of the information does tell a story. The largest portion is dues to kitchen appliances telling us the area where fires are likely to start. Next we see smokers' articles are a large contributor. Implying that those who smoke are more likely to be involved in a fire. This along with candles, perhaps unsurprisingly, indicate that open flames are an incredibly common cause of fires. Finally we see that vehicle fires are clearly frequent in the data, it is worth noting that the cause of a vehicular fire may be easily assumed and thus its prevalence bias in the data.

# Conclusion {#sec-Consclusion}

This data has supplied information regarding fire incidents in toronto. Looking into how the data changes regarding different circumstance such as location and time of day. also looking at what caused the fires and the resulting damages related to these possible factors. Geographical data showed an increase in frequency around the downtown area especially for fires occurring on properties. Outside of downtown we see a higher frequency of low damage off property incidences, with more sporadic higher damage events. Insight was also given to which times of the day result in a higher frequency of fires responded to by the Toronto fire department. Night was seen to have a much higher frequency, and far fewer in the day on average. Finally we observed the most common causes that lead to these causes seeing that smoker and kitchen appliances would be a good focus for education in the name of prevention. Policy makers can take the findings of this data to allocate resources, and understand what prevention measures are most effective.
